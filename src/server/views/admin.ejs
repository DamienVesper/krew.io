<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Krew.io Admin</title>

    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js" integrity="sha512-aMGMvNYu8Ue4G+fHa359jcPb1u+ytAF+P2SCb+PxrjCdO3n3ZTxJ30zuH39rimUggmTwmh2u7wvQsDTHESnmfQ==" crossorigin="anonymous"></script>

    <style>
        body {
            display: grid;
            background-color: #7c7d86;
        }

        #welcome_div {
            justify-self: center;
        }

        #login-div {
            text-align: center;
        }

        #login {
            margin: 5px;
        }

        #password {
            margin: 5px;
        }

        #login-btn {
            margin: 5px;
            width: 50%;
        }

        #status-message {
            font-size: 20px;
        }

        #main {
            display: none;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            grid-template-areas: ". .";
        }

        #online-players {
            color: white;
        }

        #online-boats {
            color: white;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
</head>

<body>
    <div id="welcome_div">
        <div id="logo">
            <img src="/assets/img/logotl.png">
        </div>
        <div id="login-div">
            <input id="login" placeholder="Name" type="text"><br>
            <input id="password" placeholder="Password" type="password"><br>
            <input id="login-btn" value="Login" type="button"><br>
            <div id="status-message"></div>
        </div>
    </div>
    <div id="main">
        <div id="online-players">
        </div>
        <div id="online-boats">
        </div>
        <input type="button" value="Players" id="get-players-btn">
        <input type="button" value="Boats" id="get-boats-btn">
    </div>
    <script>
        let socket = io.connect("https://krew.io:2000", {
            secure: true,
            withCredentials: true
        });
        $("#login-btn").click(function () {
            let login = $("#login").val();
            let password = $("#password").val();
            socket.emit("loginInAdminPanel", {
                login: login,
                password: password
            });
            socket.on("loginStatus", (data) => {
                if (data) {
                    $("#status-message").text(data).css("color", "green");
                    setTimeout(() => {
                        $("#welcome_div").hide()
                        $("#main").css("display", "grid");
                    }, 3000);
                } else {
                    $("#status-message").text(data).css("color", "red");
                }

            });


        });
        $("#get-players-btn").click(function () {
            socket.emit("getPlayers");

        });
        $("#get-boats-btn").click(function () {
            socket.emit("getBoats");

        });
        socket.on("players", function (data) {
            $("#online-players").empty();
            for (let z in data) {
                $("#online-players").html($("#online-players").html() + data[z].name + ' ' + data[z].parent + ' ' + data[z].ip + ' ' + '<br>');

            }
        });
        socket.on("boats", function (data) {
            $("#online-boats").empty();
            for (let z in data) {
                $("#online-boats").html($("#online-boats").html() + data[z].crewname + ' ' + data[z].id + ' ' + data[z].captainid + ' ' + '<br>');

            }
        });
    </script>
</body>

</html>